<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sii</title>
<include src="head.html">
<style type="text/css">
td label{ margin-top: 5px; }
</style>
</head>
<body>

<incache src="nav.html">

<div class="panel panel-primary">
	<div class="panel-heading">
	    <h3 class="panel-title">Sii</h3>
	</div>

	<div class="panel-body">
	<form role="form" action="index.php?app=sii&action=AdminAdd" method="post">
		<div class="form-group">
			<table class="table table-bordered">
			<tr>
				<td><label for="app_name">appname</label></td>
				<td><input type="text" class="form-control" id="appname" name="appname" placeholder="请输入APP名称,小写"></td>
			</tr>
		
			<tr>
				<td><label for="app_name">说明</label></td>
				<td><input type="text" class="form-control" id="appcomment" name="appcomment" placeholder="说明..."></td>
			</tr>
			<tr>
				<td><label for="create">创建表</label></td>
				<td>
					<label><input type="checkbox" name="create" value="1"> 是</label> 
				</td>
			</tr>
			<tr>
				<td><label for="create">创建TPL</label></td>
				<td>
					<label><input type="checkbox" name="tpl" value="1"> 是</label> 
				</td>
			</tr>
			</table>
		</div>

		<h3>字段</h3>

		<div class="form-group">
			<table class="table table-bordered" id="field_box">
			<tr id="example">
				<td>
				字段名:<input class="form-control " name="field_id" value="id"></td>
				<td>
				字段类型:
					<select name="type_id" class="form-control" id="" onchange="SetDefault(this)">
						<option value="int">INT</option>
						<option value="tinyint">TINYINT</option>
						<option value="char">CHAR</option>
						<option value="varchar">VARCHAR</option>
						<option value="text">TEXT</option>
					</select>
				</td>
				<td>
				长度:
					<input type="text" class="form-control" name="length_id" id="">
				</td>
			</tr>
			</table>
			
			<table class="table table-bordered" style="border: 1px;">
				<tr>
					<td><input  class="form-control"  type="text" id="field_name" palceholder="字段名"></td>
					<td><input  class="form-control" onclick="addline()" type="button" name="" id="" value="添加字段"></td>
				</tr>					
			</table>
		</div>	

		<button type="submit" class="btn btn-default">提交</button>
		<button class="btn btn-default" onclick="window.open('index.php?app=sii&action=siilist')">列表</button>
	</form>

	</div>
</div>
</body>            
</html>

<script type="text/javascript">
	function addline(){

		var field_name = $('#field_name').val();
		if(!field_name) return;

		var html = $('#example').html();
		rehtml = html.replace(/id/g,field_name);  //1.html可以是字符串,2.参数1不加引号,3.g表示全局(部)匹配

		var tr = $("<tr id='tr_"+field_name+"'></tr>")
		tr.append(rehtml);

		$('#field_box').append(tr);
		$('#field_name').val('');
	}

	function SetDefault(e){
		var next = $(e).parent('td').next().children('input');
		var type = $(e).val();
		switch (type) {
		    case "int":
		        next.val(11);
		        break;
		    case "char":
		        next.val(20);
		        break;
		    case "varchar":
		        next.val(32);
		        break;
		    case "tinyint":
		        next.val(4);
		        break;
		    default:
		        // next.val(32);
		}
	}
</script>
